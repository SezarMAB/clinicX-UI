<mat-card class="appointments-panel">
  <mat-card-header class="appointments-panel__header">
    <mat-card-title>مواعيد اليوم</mat-card-title>
    <mat-card-subtitle>{{ appointments().length }} موعد</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content class="appointments-panel__content">
    @if (isLoading()) {
      <div class="appointments-panel__loading">
        <mat-spinner diameter="40"></mat-spinner>
      </div>
    }

    @if (error()) {
      <div class="appointments-panel__error">
        <mat-icon>error_outline</mat-icon>
        <p>{{ error() }}</p>
      </div>
    }

    @if (!isLoading() && !error()) {
      <div class="appointments-panel__list">
        @for (appointment of appointments(); track appointment.appointmentId) {
          <div
            class="appointments-panel__card"
            [class.appointments-panel__card--selected]="isSelected(appointment.appointmentId)"
            (click)="selectAppointment(appointment)"
            tabindex="0"
            role="option"
            [attr.aria-selected]="isSelected(appointment.appointmentId)">
            
            <!-- Avatar and Patient Info -->
            <div class="appointments-panel__card-header">
              <div class="appointments-panel__avatar" [attr.data-gender]="getPatientGender(appointment)">
                <mat-icon>person</mat-icon>
              </div>
              
              <div class="appointments-panel__patient-info">
                <h3 class="appointments-panel__patient-name">{{ appointment.patientFullName }}</h3>
                <div class="appointments-panel__patient-meta">
                  <span class="appointments-panel__patient-id">#{{ appointment.patientPublicId }}</span>
                  @if (appointment.patientPhoneNumber) {
                    <span class="appointments-panel__patient-phone">
                      <mat-icon>phone</mat-icon>
                      {{ appointment.patientPhoneNumber }}
                    </span>
                  }
                </div>
              </div>
              
              <div class="appointments-panel__time-badge">
                {{ getAppointmentTime(appointment.startTime) }}
              </div>
            </div>
            
            <!-- Appointment Details -->
            <div class="appointments-panel__card-body">
              <div class="appointments-panel__appointment-type">
                <mat-icon>medical_services</mat-icon>
                {{ appointment.appointmentType }}
              </div>
              
              @if (appointment.practitionerTag) {
                <div class="appointments-panel__practitioner-tag">
                  {{ appointment.practitionerTag }}
                </div>
              }
            </div>
            
            <!-- Status Badge -->
            <div class="appointments-panel__status-badge" [attr.data-status]="getStatusClass(appointment.status)">
              {{ getStatusLabel(appointment.status) }}
            </div>
          </div>
        }

        @if (appointments().length === 0) {
          <div class="appointments-panel__empty">
            <mat-icon>event_busy</mat-icon>
            <p>لا توجد مواعيد لهذا اليوم</p>
          </div>
        }
      </div>
    }
  </mat-card-content>
</mat-card>
